from datetime import datetime, timedelta
import calendar

def calculate_easter(year):
    """Calculate the date of Orthodox Easter using Meeus's algorithm."""
    a = year % 19
    b = year % 4
    c = year % 7
    d = (19 * a + 15) % 30
    e = (2 * b + 4 * c + 6 * d + 6) % 7
    f = d + e
    
    if f <= 9:
        day = f + 22
        month = 3
    else:
        day = f - 9
        month = 4
    
    # Convert from Julian to Gregorian calendar
    julian_date = datetime(year, month, day)
    gregorian_date = julian_date + timedelta(days=13)
    
    return gregorian_date.strftime("%m-%d")

def calculate_vyshyvanka_day(year):
    """Calculate Vyshyvanka Day (third Thursday in May)."""
    c = calendar.monthcalendar(year, 5)
    thursdays = [week[calendar.THURSDAY] for week in c if week[calendar.THURSDAY] != 0]
    third_thursday = thursdays[2]
    return f"05-{third_thursday:02d}"

def calculate_trinity_day(year):
    """Calculate Trinity Day (50 days after Easter)."""
    easter_date = datetime.strptime(f"{year}-{calculate_easter(year)}", "%Y-%m-%d")
    trinity_date = easter_date + timedelta(days=49)
    return trinity_date.strftime("%m-%d")

def get_dynamic_holidays(year):
    """Get holidays with dynamic dates for a specific year."""
    return {
        calculate_easter(year): "ðŸ£ Ð’ÐµÐ»Ð¸ÐºÐ´ÐµÐ½ÑŒ",
        calculate_vyshyvanka_day(year): "ðŸŒº Ð”ÐµÐ½ÑŒ Ð²Ð¸ÑˆÐ¸Ð²Ð°Ð½ÐºÐ¸",
        calculate_trinity_day(year): "ðŸŒ¿ Ð¢Ñ€Ñ–Ð¹Ñ†Ñ"
    }

# Static holidays and significant dates
STATIC_HOLIDAYS = {
    # Ð¡Ñ–Ñ‡ÐµÐ½ÑŒ
    "01-01": "ðŸŽ„ ÐÐ¾Ð²Ð¸Ð¹ Ñ€Ñ–Ðº",
    "01-06": "ðŸŒŸ Ð¡Ð²ÑÑ‚Ð²ÐµÑ‡Ñ–Ñ€",
    "01-07": "ðŸŽ„ Ð Ñ–Ð·Ð´Ð²Ð¾ Ð¥Ñ€Ð¸ÑÑ‚Ð¾Ð²Ðµ (Ð·Ð° ÑŽÐ»Ñ–Ð°Ð½ÑÑŒÐºÐ¸Ð¼ ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÐµÐ¼)",
    "01-14": "ðŸŽ‰ Ð¡Ñ‚Ð°Ñ€Ð¸Ð¹ ÐÐ¾Ð²Ð¸Ð¹ Ñ€Ñ–Ðº",
    "01-22": "ðŸ‡ºðŸ‡¦ Ð”ÐµÐ½ÑŒ Ð¡Ð¾Ð±Ð¾Ñ€Ð½Ð¾ÑÑ‚Ñ– Ð£ÐºÑ€Ð°Ñ—Ð½Ð¸",
    "01-27": "ðŸ•¯ï¸ ÐœÑ–Ð¶Ð½Ð°Ñ€Ð¾Ð´Ð½Ð¸Ð¹ Ð´ÐµÐ½ÑŒ Ð¿Ð°Ð¼'ÑÑ‚Ñ– Ð¶ÐµÑ€Ñ‚Ð² Ð“Ð¾Ð»Ð¾ÐºÐ¾ÑÑ‚Ñƒ",
    
    # Ð›ÑŽÑ‚Ð¸Ð¹
    "02-15": "ðŸ•¯ï¸ Ð”ÐµÐ½ÑŒ Ð²ÑˆÐ°Ð½ÑƒÐ²Ð°Ð½Ð½Ñ ÑƒÑ‡Ð°ÑÐ½Ð¸ÐºÑ–Ð² Ð±Ð¾Ð¹Ð¾Ð²Ð¸Ñ… Ð´Ñ–Ð¹ Ð½Ð° Ñ‚ÐµÑ€Ð¸Ñ‚Ð¾Ñ€Ñ–Ñ— Ñ–Ð½ÑˆÐ¸Ñ… Ð´ÐµÑ€Ð¶Ð°Ð²",
    "02-20": "ðŸ•¯ï¸ Ð”ÐµÐ½ÑŒ Ð“ÐµÑ€Ð¾Ñ—Ð² ÐÐµÐ±ÐµÑÐ½Ð¾Ñ— Ð¡Ð¾Ñ‚Ð½Ñ–",
    
    # Ð‘ÐµÑ€ÐµÐ·ÐµÐ½ÑŒ
    "03-08": "ðŸŒ· ÐœÑ–Ð¶Ð½Ð°Ñ€Ð¾Ð´Ð½Ð¸Ð¹ Ð¶Ñ–Ð½Ð¾Ñ‡Ð¸Ð¹ Ð´ÐµÐ½ÑŒ",
    "03-09": "ðŸ“š Ð”ÐµÐ½ÑŒ Ð½Ð°Ñ€Ð¾Ð´Ð¶ÐµÐ½Ð½Ñ Ð¢Ð°Ñ€Ð°ÑÐ° Ð¨ÐµÐ²Ñ‡ÐµÐ½ÐºÐ°",
    "03-14": "ðŸ‡ºðŸ‡¦ Ð”ÐµÐ½ÑŒ ÑƒÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ¾Ð³Ð¾ Ð´Ð¾Ð±Ñ€Ð¾Ð²Ð¾Ð»ÑŒÑ†Ñ",
    
    # ÐšÐ²Ñ–Ñ‚ÐµÐ½ÑŒ
    "04-26": "ðŸ•¯ï¸ Ð”ÐµÐ½ÑŒ Ñ‡Ð¾Ñ€Ð½Ð¾Ð±Ð¸Ð»ÑŒÑÑŒÐºÐ¾Ñ— Ñ‚Ñ€Ð°Ð³ÐµÐ´Ñ–Ñ—",
    
    # Ð¢Ñ€Ð°Ð²ÐµÐ½ÑŒ
    "05-01": "ðŸŒ± Ð”ÐµÐ½ÑŒ Ð¿Ñ€Ð°Ñ†Ñ–",
    "05-08": "ðŸ•¯ï¸ Ð”ÐµÐ½ÑŒ Ð¿Ð°Ð¼'ÑÑ‚Ñ– Ñ‚Ð° Ð¿Ñ€Ð¸Ð¼Ð¸Ñ€ÐµÐ½Ð½Ñ",
    "05-09": "ðŸŽ–ï¸ Ð”ÐµÐ½ÑŒ Ð¿ÐµÑ€ÐµÐ¼Ð¾Ð³Ð¸ Ð½Ð°Ð´ Ð½Ð°Ñ†Ð¸Ð·Ð¼Ð¾Ð¼ Ñƒ Ð”Ñ€ÑƒÐ³Ñ–Ð¹ ÑÐ²Ñ–Ñ‚Ð¾Ð²Ñ–Ð¹ Ð²Ñ–Ð¹Ð½Ñ–",
    "05-15": "ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ ÐœÑ–Ð¶Ð½Ð°Ñ€Ð¾Ð´Ð½Ð¸Ð¹ Ð´ÐµÐ½ÑŒ ÑÑ–Ð¼'Ñ—",
    
    # Ð§ÐµÑ€Ð²ÐµÐ½ÑŒ
    "06-01": "ðŸ‘¶ ÐœÑ–Ð¶Ð½Ð°Ñ€Ð¾Ð´Ð½Ð¸Ð¹ Ð´ÐµÐ½ÑŒ Ð·Ð°Ñ…Ð¸ÑÑ‚Ñƒ Ð´Ñ–Ñ‚ÐµÐ¹",
    "06-28": "ðŸ‡ºðŸ‡¦ Ð”ÐµÐ½ÑŒ ÐšÐ¾Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ñ–Ñ— Ð£ÐºÑ€Ð°Ñ—Ð½Ð¸",
    
    # Ð›Ð¸Ð¿ÐµÐ½ÑŒ
    "07-28": "ðŸ‡ºðŸ‡¦ Ð”ÐµÐ½ÑŒ Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ¾Ñ— Ð”ÐµÑ€Ð¶Ð°Ð²Ð½Ð¾ÑÑ‚Ñ–",
    
    # Ð¡ÐµÑ€Ð¿ÐµÐ½ÑŒ
    "08-24": "ðŸ‡ºðŸ‡¦ Ð”ÐµÐ½ÑŒ ÐÐµÐ·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚Ñ– Ð£ÐºÑ€Ð°Ñ—Ð½Ð¸",
    
    # Ð’ÐµÑ€ÐµÑÐµÐ½ÑŒ
    "09-01": "ðŸŽ“ Ð”ÐµÐ½ÑŒ Ð·Ð½Ð°Ð½ÑŒ",
    "09-30": "ðŸ“š Ð”ÐµÐ½ÑŒ Ð±Ñ–Ð±Ð»Ñ–Ð¾Ñ‚ÐµÐº",
    
    # Ð–Ð¾Ð²Ñ‚ÐµÐ½ÑŒ
    "10-01": "ðŸŽµ ÐœÑ–Ð¶Ð½Ð°Ñ€Ð¾Ð´Ð½Ð¸Ð¹ Ð´ÐµÐ½ÑŒ Ð¼ÑƒÐ·Ð¸ÐºÐ¸",
    "10-14": "ðŸŽ–ï¸ Ð”ÐµÐ½ÑŒ Ð·Ð°Ñ…Ð¸ÑÐ½Ð¸ÐºÑ–Ð² Ñ– Ð·Ð°Ñ…Ð¸ÑÐ½Ð¸Ñ†ÑŒ Ð£ÐºÑ€Ð°Ñ—Ð½Ð¸",
    
    # Ð›Ð¸ÑÑ‚Ð¾Ð¿Ð°Ð´
    "11-09": "ðŸ“š Ð”ÐµÐ½ÑŒ ÑƒÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ¾Ñ— Ð¿Ð¸ÑÐµÐ¼Ð½Ð¾ÑÑ‚Ñ– Ñ‚Ð° Ð¼Ð¾Ð²Ð¸",
    "11-21": "ðŸ‡ºðŸ‡¦ Ð”ÐµÐ½ÑŒ Ð“Ñ–Ð´Ð½Ð¾ÑÑ‚Ñ– Ñ‚Ð° Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð¸",
    "11-26": "ðŸ•¯ï¸ Ð”ÐµÐ½ÑŒ Ð¿Ð°Ð¼'ÑÑ‚Ñ– Ð¶ÐµÑ€Ñ‚Ð² Ð³Ð¾Ð»Ð¾Ð´Ð¾Ð¼Ð¾Ñ€Ñ–Ð²",
    
    # Ð“Ñ€ÑƒÐ´ÐµÐ½ÑŒ
    "12-06": "ðŸŽ–ï¸ Ð”ÐµÐ½ÑŒ Ð—Ð±Ñ€Ð¾Ð¹Ð½Ð¸Ñ… Ð¡Ð¸Ð» Ð£ÐºÑ€Ð°Ñ—Ð½Ð¸",
    "12-19": "ðŸŽ… Ð”ÐµÐ½ÑŒ Ð¡Ð²ÑÑ‚Ð¾Ð³Ð¾ ÐœÐ¸ÐºÐ¾Ð»Ð°Ñ",
    "12-25": "ðŸŽ„ Ð Ñ–Ð·Ð´Ð²Ð¾ Ð¥Ñ€Ð¸ÑÑ‚Ð¾Ð²Ðµ (Ð·Ð° Ð³Ñ€Ð¸Ð³Ð¾Ñ€Ñ–Ð°Ð½ÑÑŒÐºÐ¸Ð¼ ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÐµÐ¼)"
}

def get_all_holidays(year=None):
    """Get all holidays including dynamic dates."""
    if year is None:
        year = datetime.now().year
        
    all_holidays = STATIC_HOLIDAYS.copy()
    all_holidays.update(get_dynamic_holidays(year))
    return all_holidays 